# 要件定義書：Kidz8
## 1. 概要
**Kidz8**は、プログラミング講師や教育機関向けに設計された、Python学習のための教材管理・課題提出・進捗可視化を一体化したWebアプリケーションです。
教材 → レッスン → 宿題（＋テストケース）という構造で学習を段階的に進められ、講師は学習者の理解度をリアルタイムで把握・評価できます。

## 2. ユーザー種別

| ユーザー種別  | 機能概要                                            |
| ------- | ----------------------------------------------- |
| 管理者（講師） | 教材・レッスン・宿題・テストケースの作成／編集／削除、学習者管理、提出評価、進捗確認、コメント |
| 学習者     | 割り当てられた教材の閲覧、宿題へのコード提出、結果確認、フィードバック受信、進捗グラフ確認   |

## 3. コンテンツ構造と関係性

```
教材（Material）
└── レッスン（Lesson）
    └── 宿題（Assignment）
        └── テストケース（Testcase）
```

* 教材：大きな単元（例：Python入門）
* レッスン：章やトピック（例：変数・条件分岐）
* 宿題：実際にコードを書く課題
* テストケース：宿題の正誤判定に使用される複数の入出力ペア

## 4. 機能要件

### 4.1 認証・アカウント管理

* ログイン／ログアウト（JWTまたはセッション）
* パスワード変更・リセット
* ユーザー登録（講師による学習者登録）

### 4.2 教材管理（管理者）

* 教材の一覧表示、作成、編集、削除
* 教材にレッスンを紐付け可能

### 4.3 レッスン管理（管理者）

* レッスンの作成・編集・削除（教材に紐付け）
* レッスンごとに宿題を複数追加可能
* レッスンの説明・解説を記述

### 4.4 宿題管理（管理者）

* 宿題タイトル、説明、問題文、入力例、正解出力の登録
* 添付ファイル（画像・PDFなど）の追加
* 宿題ごとに複数のテストケースを登録

### 4.5 テストケース管理（管理者）

* 宿題に対して複数のテストケース（入力・期待出力）を登録・編集・削除
* それぞれに解説コメントを記述可能（任意）

### 4.6 宿題提出（学習者）

* 学習者は宿題ごとにブラウザ上のPythonエディタでコードを記述
* 提出処理（API経由でバックエンド実行）
* 結果表示（成功/失敗＋失敗したテストケース内容）
* 再提出可能

### 4.7 採点・判定ロジック

* 宿題提出時、登録された全テストケースに対してコードを実行
* すべての出力が正解一致 → 正解
* 1つでも不一致 → 不正解（失敗したケースを表示）

### 4.8 学習ログ・進捗グラフ（可視化）

#### 学習者用

* 自分の提出数／正解数／未提出数（円グラフ）
* 日別提出数（棒グラフ）
* 教材別進捗率（バー）

#### 管理者用

* 学習者ごとの成績表（正解率、提出数）
* 教材/レッスン別の学習者進捗割合
* 未提出者の一覧表示

## 5. 非機能要件

| 項目      | 内容                                   |
| ------- | ------------------------------------ |
| 同時接続想定  | 最大100名程度                             |
| セキュリティ  | SQLインジェクション/XSS対策、コード実行はサンドボックスで安全管理 |
| パフォーマンス | グラフ等は集計キャッシュを利用                      |
| 使用ブラウザ  | 最新のChrome / Safari（PC・タブレット対応）       |

## 6. データベース構成（主要テーブル）

| テーブル          | 主なカラム                                                                          |
| ------------- | ------------------------------------------------------------------------------ |
| `users`       | id, name, email, password, role (admin/user)                                   |
| `materials`   | id, title, description, created\_at                                            |
| `lessons`     | id, material\_id, title, content                                               |
| `assignments` | id, lesson\_id, title, description, question\_text, input\_example, file\_path |
| `testcases`   | id, assignment\_id, input, expected\_output, comment                           |
| `submissions` | id, user\_id, assignment\_id, code, is\_correct, feedback, submitted\_at       |

## 7. 技術スタック（推奨）

| 分類      | 技術                           |
| ------- | ---------------------------- |
| フロントエンド | React（Vite）＋TypeScript       |
| グラフ表示   | RechartsまたはChart.js          |
| バックエンド  | PHP 8+（REST API構成）           |
| 実行環境    | Python（CLIでバックエンドからexec安全実行） |
| データベース  | SQLite（軽量DB）                 |
| デプロイ先   | Xserver（レンタルーサーバー）           |

## 8. 参考文献

* [iiiar論文](https://iiiar.org/iiars/doc/iiars_workshop7_2_2.pdf)：学習ログ可視化・分析
* [nawaten教育プロジェクト](https://2022.nawaten.online/project/2711)：学習者UI/UXの参考

## 実装優先順位（例）

1. 認証・ユーザー管理
2. 教材／レッスン／宿題の作成UI
3. 宿題提出＋テストケース実行
4. 自動採点ロジック
5. 学習者・講師ダッシュボード（進捗可視化）


## 起動方法

Docker Compose を使用してフロントエンドとバックエンドを同時に起動できます。フロントエンドは Vite の開発サーバーで起動します：

```bash
docker-compose up --build
````

* フロントエンド: [http://localhost:3000](http://localhost:3000)
* バックエンド API: [http://localhost:5050](http://localhost:5050)

### ダッシュボード

学習者用 `/dashboard` と管理者用 `/admin/dashboard` では Recharts を利用した
円グラフ・棒グラフ・進捗バーで提出状況を確認できます。

### API キャッシュ

`/api/progress` の集計結果は 60 秒間キャッシュされます。`force=1` を
クエリに付与するとキャッシュを無視して再計算できます。
